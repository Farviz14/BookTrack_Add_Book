function cov_jq7l7ock2(){var path="C:\\Users\\farvi\\OneDrive\\Desktop\\Year 2 Sem 4\\DevOPS Essentials\\Project 2\\BookTrack_Add_Book\\utils\\search-book-util.js";var hash="bbf1dfc6cf8e6ddbb97e49867f70fa91fa338abb";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\farvi\\OneDrive\\Desktop\\Year 2 Sem 4\\DevOPS Essentials\\Project 2\\BookTrack_Add_Book\\utils\\search-book-util.js",statementMap:{"0":{start:{line:2,column:13},end:{line:2,column:41}},"1":{start:{line:3,column:17},end:{line:3,column:36}},"2":{start:{line:6,column:18},end:{line:6,column:48}},"3":{start:{line:9,column:4},end:{line:11,column:5}},"4":{start:{line:10,column:8},end:{line:10,column:121}},"5":{start:{line:13,column:4},end:{line:15,column:5}},"6":{start:{line:14,column:8},end:{line:14,column:99}},"7":{start:{line:17,column:4},end:{line:33,column:5}},"8":{start:{line:19,column:30},end:{line:21,column:10}},"9":{start:{line:24,column:8},end:{line:26,column:9}},"10":{start:{line:25,column:12},end:{line:25,column:93}},"11":{start:{line:29,column:8},end:{line:29,column:44}},"12":{start:{line:31,column:8},end:{line:31,column:54}},"13":{start:{line:32,column:8},end:{line:32,column:112}},"14":{start:{line:38,column:4},end:{line:38,column:58}},"15":{start:{line:41,column:0},end:{line:41,column:33}}},fnMap:{"0":{name:"searchBooks",decl:{start:{line:5,column:15},end:{line:5,column:26}},loc:{start:{line:5,column:37},end:{line:34,column:1}},line:5},"1":{name:"escapeRegex",decl:{start:{line:37,column:9},end:{line:37,column:20}},loc:{start:{line:37,column:27},end:{line:39,column:1}},line:37}},branchMap:{"0":{loc:{start:{line:9,column:4},end:{line:11,column:5}},type:"if",locations:[{start:{line:9,column:4},end:{line:11,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:9},"1":{loc:{start:{line:9,column:8},end:{line:9,column:66}},type:"binary-expr",locations:[{start:{line:9,column:8},end:{line:9,column:14}},{start:{line:9,column:18},end:{line:9,column:43}},{start:{line:9,column:47},end:{line:9,column:66}}],line:9},"2":{loc:{start:{line:13,column:4},end:{line:15,column:5}},type:"if",locations:[{start:{line:13,column:4},end:{line:15,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:13},"3":{loc:{start:{line:24,column:8},end:{line:26,column:9}},type:"if",locations:[{start:{line:24,column:8},end:{line:26,column:9}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:24}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"bbf1dfc6cf8e6ddbb97e49867f70fa91fa338abb"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_jq7l7ock2=function(){return actualCoverage;};}return actualCoverage;}cov_jq7l7ock2();// Import the Book model to interact with the database
const Book=(cov_jq7l7ock2().s[0]++,require('../models/book.js'));const mongoose=(cov_jq7l7ock2().s[1]++,require('mongoose'));// Import mongoose to validate object IDs
async function searchBooks(req,res){cov_jq7l7ock2().f[0]++;const query=(cov_jq7l7ock2().s[2]++,req.query.query?.toLowerCase());// Use optional chaining to safely access query
// Check if the query is provided and valid
cov_jq7l7ock2().s[3]++;if((cov_jq7l7ock2().b[1][0]++,!query)||(cov_jq7l7ock2().b[1][1]++,typeof query!=='string')||(cov_jq7l7ock2().b[1][2]++,query.trim()==='')){cov_jq7l7ock2().b[0][0]++;cov_jq7l7ock2().s[4]++;return res.status(400).json({error:'Invalid parameter: "query" is required and must be a non-empty string.'});}else{cov_jq7l7ock2().b[0][1]++;}// Limit query length to 100 characters
cov_jq7l7ock2().s[5]++;if(query.length>100){cov_jq7l7ock2().b[2][0]++;cov_jq7l7ock2().s[6]++;return res.status(400).json({error:'Query is too long. Max length is 100 characters.'});}else{cov_jq7l7ock2().b[2][1]++;}cov_jq7l7ock2().s[7]++;try{// Search for books that match the title 
const filteredBooks=(cov_jq7l7ock2().s[8]++,await Book.find({title:{$regex:escapeRegex(query),$options:'i'}// Case-insensitive search with escaped query
}));// Check if any books are found
cov_jq7l7ock2().s[9]++;if(filteredBooks.length===0){cov_jq7l7ock2().b[3][0]++;cov_jq7l7ock2().s[10]++;return res.status(404).json({message:'No books found matching your search.'});}else{cov_jq7l7ock2().b[3][1]++;}// Return the filtered results
cov_jq7l7ock2().s[11]++;res.status(200).json(filteredBooks);// Send 200 OK status with the results
}catch(error){cov_jq7l7ock2().s[12]++;console.error('Error fetching books:',error);cov_jq7l7ock2().s[13]++;res.status(500).json({message:'An error occurred while searching for books.',error:error.message});}}// Function to escape regex special characters
function escapeRegex(text){cov_jq7l7ock2().f[1]++;cov_jq7l7ock2().s[14]++;return text.replace(/[-\/\\^$.*+?()[\]{}|]/g,'\\$&');// Escape special characters
}cov_jq7l7ock2().s[15]++;module.exports={searchBooks};// Export the searchBooks function to be used in index.js
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfanE3bDdvY2syIiwiYWN0dWFsQ292ZXJhZ2UiLCJCb29rIiwicyIsInJlcXVpcmUiLCJtb25nb29zZSIsInNlYXJjaEJvb2tzIiwicmVxIiwicmVzIiwiZiIsInF1ZXJ5IiwidG9Mb3dlckNhc2UiLCJiIiwidHJpbSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImxlbmd0aCIsImZpbHRlcmVkQm9va3MiLCJmaW5kIiwidGl0bGUiLCIkcmVnZXgiLCJlc2NhcGVSZWdleCIsIiRvcHRpb25zIiwibWVzc2FnZSIsImNvbnNvbGUiLCJ0ZXh0IiwicmVwbGFjZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJzZWFyY2gtYm9vay11dGlsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEltcG9ydCB0aGUgQm9vayBtb2RlbCB0byBpbnRlcmFjdCB3aXRoIHRoZSBkYXRhYmFzZVxyXG5jb25zdCBCb29rID0gcmVxdWlyZSgnLi4vbW9kZWxzL2Jvb2suanMnKTtcclxuY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpOyAvLyBJbXBvcnQgbW9uZ29vc2UgdG8gdmFsaWRhdGUgb2JqZWN0IElEc1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2VhcmNoQm9va3MocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IHF1ZXJ5ID0gcmVxLnF1ZXJ5LnF1ZXJ5Py50b0xvd2VyQ2FzZSgpOyAvLyBVc2Ugb3B0aW9uYWwgY2hhaW5pbmcgdG8gc2FmZWx5IGFjY2VzcyBxdWVyeVxyXG5cclxuICAgIC8vIENoZWNrIGlmIHRoZSBxdWVyeSBpcyBwcm92aWRlZCBhbmQgdmFsaWRcclxuICAgIGlmICghcXVlcnkgfHwgdHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJyB8fCBxdWVyeS50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIHBhcmFtZXRlcjogXCJxdWVyeVwiIGlzIHJlcXVpcmVkIGFuZCBtdXN0IGJlIGEgbm9uLWVtcHR5IHN0cmluZy4nIH0pO1xyXG4gICAgfVxyXG4gICAgLy8gTGltaXQgcXVlcnkgbGVuZ3RoIHRvIDEwMCBjaGFyYWN0ZXJzXHJcbiAgICBpZiAocXVlcnkubGVuZ3RoID4gMTAwKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdRdWVyeSBpcyB0b28gbG9uZy4gTWF4IGxlbmd0aCBpcyAxMDAgY2hhcmFjdGVycy4nIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgICAgLy8gU2VhcmNoIGZvciBib29rcyB0aGF0IG1hdGNoIHRoZSB0aXRsZSBcclxuICAgICAgICBjb25zdCBmaWx0ZXJlZEJvb2tzID0gYXdhaXQgQm9vay5maW5kKHtcclxuICAgICAgICAgICAgdGl0bGU6IHsgJHJlZ2V4OiBlc2NhcGVSZWdleChxdWVyeSksICRvcHRpb25zOiAnaScgfSAvLyBDYXNlLWluc2Vuc2l0aXZlIHNlYXJjaCB3aXRoIGVzY2FwZWQgcXVlcnlcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgYW55IGJvb2tzIGFyZSBmb3VuZFxyXG4gICAgICAgIGlmIChmaWx0ZXJlZEJvb2tzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiAnTm8gYm9va3MgZm91bmQgbWF0Y2hpbmcgeW91ciBzZWFyY2guJyB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFJldHVybiB0aGUgZmlsdGVyZWQgcmVzdWx0c1xyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGZpbHRlcmVkQm9va3MpOyAvLyBTZW5kIDIwMCBPSyBzdGF0dXMgd2l0aCB0aGUgcmVzdWx0c1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBib29rczonLCBlcnJvcik7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgc2VhcmNoaW5nIGZvciBib29rcy4nLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gZXNjYXBlIHJlZ2V4IHNwZWNpYWwgY2hhcmFjdGVyc1xyXG5mdW5jdGlvbiBlc2NhcGVSZWdleCh0ZXh0KSB7XHJcbiAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC9bLVxcL1xcXFxeJC4qKz8oKVtcXF17fXxdL2csICdcXFxcJCYnKTsgLy8gRXNjYXBlIHNwZWNpYWwgY2hhcmFjdGVyc1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHsgc2VhcmNoQm9va3MgfTsgLy8gRXhwb3J0IHRoZSBzZWFyY2hCb29rcyBmdW5jdGlvbiB0byBiZSB1c2VkIGluIGluZGV4LmpzIl0sIm1hcHBpbmdzIjoieTVGQWVZO0FBQUFBLGFBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsYUFBQSxHQWZaO0FBQ0EsS0FBTSxDQUFBRSxJQUFJLEVBQUFGLGFBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsRUFDekMsS0FBTSxDQUFBQyxRQUFRLEVBQUFMLGFBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUU7QUFFdEMsY0FBZSxDQUFBRSxXQUFXQSxDQUFDQyxHQUFHLENBQUVDLEdBQUcsQ0FBRSxDQUFBUixhQUFBLEdBQUFTLENBQUEsTUFDakMsS0FBTSxDQUFBQyxLQUFLLEVBQUFWLGFBQUEsR0FBQUcsQ0FBQSxNQUFHSSxHQUFHLENBQUNHLEtBQUssQ0FBQ0EsS0FBSyxFQUFFQyxXQUFXLENBQUMsQ0FBQyxFQUFFO0FBRTlDO0FBQUFYLGFBQUEsR0FBQUcsQ0FBQSxNQUNBLEdBQUksQ0FBQUgsYUFBQSxHQUFBWSxDQUFBLFVBQUNGLEtB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